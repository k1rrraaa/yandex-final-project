# Yandex Final Project 

## TL;DR (–°—É—Ç—å —Ä–µ—à–µ–Ω–∏—è –≤ –¥–≤—É—Ö —Å–ª–æ–≤–∞—Ö)

> –®–µ—Å—Ç–∏–º–æ–¥–µ–ª—å–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π **soft-–∞–Ω—Å–∞–º–±–ª—å** (ConvNeXt-–≤–∞—Ä–∏–∞—Ü–∏–∏, EfficientNet-like, TinyViT'—ã).  
> –ù–∞ –ª–æ–≥–∏—Ç–∞—Ö –º–æ–¥–µ–ª–µ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–µ –±—É—Å—Ç–∏–Ω–≥–∏: CatBoost –∏ LightGBM.  
> –§–∏–Ω–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä ‚Äî –≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:  
> **0.4 √ó CatBoost + 0.3 √ó LightGBM + 0.3 √ó Soft Voting –∞–Ω—Å–∞–º–±–ª—å**.  
> **Score –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ Kaggle:** [0.74614](https://www.kaggle.com/competitions/ml-intensive-yandex-academy-spring-2025/overview)


## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

1. **–ú–æ–¥—É–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ 6 –º–æ–¥–µ–ª–µ–π**  
   –ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –æ–±—É—á–∞–ª–∞—Å—å –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.  
   üëâ [–°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∏—Ö –æ–±—É—á–µ–Ω–∏—è](#final-models)

2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Ç–æ–≤ –∏ –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**  
   –°–æ—Ö—Ä–∞–Ω–∏–ª–∏ –ª–æ–≥–∏—Ç—ã –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –¥–ª—è soft-voting –∞–Ω—Å–∞–º–±–ª—è –ø–æ–¥–æ–±—Ä–∞–ª–∏ –≤–µ—Å–∞ —á–µ—Ä–µ–∑ Optuna.  
   –¢–∞–º –∂–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ Test-Time Augmentation (TTA).

3. **–§–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–∞-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä**  
   –ù–∞ –ª–æ–≥–∏—Ç–∞—Ö –æ–±—É—á–∏–ª–∏ CatBoost –∏ LightGBM. –°–¥–µ–ª–∞–ª–∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç.

## Final Models

–í —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å –≤–æ—à–ª–∏ 6 **–æ–±—É—á–µ–Ω–Ω—ã—Ö —Å –Ω—É–ª—è** –º–æ–¥–µ–ª–µ–π.

–í —Ä–µ—à–µ–Ω–∏–∏ **–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏** ([teacher](notebooks/060_teacher.ipynb)), –∏ **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"** ([tinyvit_test](notebooks/05_vit_from_box(test).ipynb)). 

üìä **F1-scores –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ):** (—Å —É—á–µ—Ç–æ–º TTA, —Ä–µ–∞–ª—å–Ω—ã–µ –Ω–∏–∂–µ)

- [`miniconvnext`](#miniconvnext): **0.6969**
- [`tiny_vit_no_ssl`](#tiny_vit_no_ssl): **0.7207**
- [`tiny_vit_ssl`](#tiny_vit_ssl): **0.7252**
- [`enet_v2_m`](#enet_v2_m): **0.7147**
- [`convnextv2_base`](#convnextv2_base): **0.6958**
- [`convnextv2_small`](#convnextv2_small): **0.7188**

### –û–±—â–µ–µ –ø–æ –º–æ–¥–µ–ª—è–º

**üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –≤–µ—Å–∞ –º–æ–¥–µ–ª–µ–π ‚Üí [Yandex Disk](https://disk.yandex.ru/d/DfZp4Qd3suAzPQ)**

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –≤—Å–µ—Ö —à–µ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –µ–¥–∏–Ω—ã–π –Ω–∞–±–æ—Ä –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π:

- üìê **RandomResizedCrop** ‚Äî —Å –≤–∞—Ä—å–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º–∞—Å—à—Ç–∞–±–∞ –æ—Ç 50% –¥–æ 100% –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω –æ—Ç 0.75 –¥–æ 1.33
- üîÑ **RandomHorizontalFlip** ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 50%
- üéõ **RandAugment** ‚Äî 2 —Å–ª—É—á–∞–π–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å—é 9 (–∏–∑ 14 –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π)
- üé® **ColorJitter** ‚Äî –∏–∑–º–µ–Ω—è—é—Ç—Å—è —è—Ä–∫–æ—Å—Ç—å, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å, –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å –∏ –æ—Ç—Ç–µ–Ω–æ–∫
- üìâ **Normalize** ‚Äî –ø–æ –∫–∞–Ω–∞–ª–∞–º —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ `mean` –∏ `std`
- üö´ **RandomErasing** ‚Äî —Å—Ç–∏—Ä–∞–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 25% (—É –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±—ã–ª–∞ 50%)
- üß¨ **MixUp / CutMix** ‚Äî –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞—Ç—á–µ–π –≤–æ –≤—Å–µ—Ö –º–æ–¥–µ–ª—è—Ö;  
  —á–∞—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ, —á–∞—Å—Ç—å ‚Äî –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `timm`  

> üß™ –ë—ã–ª–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è–º–∏  
(—Å–º. [`src/augmentations.py`](src/augmentations.py)) –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ EfficientNetV2 (—Å–º. [`091_strong_enet_v2_m.ipynb`](notebooks/091_strong_enetv2_m.ipynb)),  
–Ω–æ –æ–Ω–∏ –Ω–µ –¥–∞–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∏—Ä–æ—Å—Ç–∞ –º–µ—Ç—Ä–∏–∫ –∏ —Å–∏–ª—å–Ω–æ —É—Ö—É–¥—à–∞–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å TTA,  
–ø–æ—ç—Ç–æ–º—É –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ —É–º–µ—Ä–µ–Ω–Ω–æ-—Å–∏–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è—Ö.

### miniconvnext

**üìÅ –û–±—É—á–µ–Ω–∏–µ:** [`04_miniconvnext_strong.ipynb`](notebooks/04_miniconvnext_strong.ipynb)  
**üß± –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** [`src/models/miniconvnext.py`](src/models/miniconvnext.py)  
**üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è ConvNeXt (~1.6M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)  
**‚è≥ –í—Å–µ–≥–æ —ç–ø–æ—Ö:** 350 (–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ scheduler'–∞–º–∏)  
**üíæ –í–µ—Å–∞:** `convnext_last.pth` ‚Äî [—Å–∫–∞—á–∞—Ç—å —Å Yandex Disk](https://disk.yandex.ru/d/DfZp4Qd3suAzPQ)  
**üß™ F1-score (–≤–∞–ª–∏–¥–∞—Ü–∏—è):** **0.6969**


**‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –ó–Ω–∞—á–µ–Ω–∏–µ                                |
|---------------|-----------------------------------------|
| –û–ø—Ç–∏–º–∞–π–∑–µ—Ä    | `AdamW`, `lr=3e-5`, `weight_decay=1e-4` |
| Scheduler     | `OneCycleLR` / `CosineAnnealingLR`      |
| –≠–ø–æ—Ö          | –æ—Ç 50 –¥–æ 100 (–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤)       |
| Loss          | `CrossEntropyLoss` + `LabelSmoothing=0.1` |
| MixUp         | `alpha=1.0`, `p=0.2‚Äì0.5`             |
| CutMix        | `alpha=1.0`, `p=0.5‚Äì0.8`                 |

üìù –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ scheduler –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π.  
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [`–Ω–æ—É—Ç–±—É–∫–µ`](notebooks/04_miniconvnext_strong.ipynb).

### tiny_vit_no_ssl

**üìÅ –û–±—É—á–µ–Ω–∏–µ:** [`080_tinyvit_11m.ipynb`](notebooks/080_tinyvit_11m.ipynb)  
**üß± –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** [`src/models/tiny_vit.py`](src/models/tinyvit.py)  
**üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `TinyViT-11M`  
**‚è≥ –í—Å–µ–≥–æ —ç–ø–æ—Ö:** 275  
**üíæ –í–µ—Å–∞:** `my_vit_4_best.pth` ‚Äî [—Å–∫–∞—á–∞—Ç—å —Å Yandex Disk](https://disk.yandex.ru/d/DfZp4Qd3suAzPQ)  
**üß™ F1-score (–≤–∞–ª–∏–¥–∞—Ü–∏—è):** **0.7207**

**‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –ó–Ω–∞—á–µ–Ω–∏–µ                                |
|---------------|-----------------------------------------|
| –û–ø—Ç–∏–º–∞–π–∑–µ—Ä    | `AdamW`, `lr=3e-4`, `weight_decay=1e-4` |
| Scheduler     | `OneCycleLR` / `CosineAnnealingLR`      |
| –≠–ø–æ—Ö          | –æ—Ç 50 –¥–æ 75 (–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤)       |
| Loss          | `CrossEntropyLoss` + `LabelSmoothing=0.1` |
| MixUp         | `alpha=0.25-1.0`, `p=0.5`             |
| CutMix        | `alpha=0.25-1.0`, `p=0.5`                 |

üìù –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ scheduler –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π.  
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [`–Ω–æ—É—Ç–±—É–∫–µ`](notebooks/080_tinyvit_11m.ipynb).

### tiny_vit_ssl

**üìÅ –û–±—É—á–µ–Ω–∏–µ:** [`071_SSL.ipynb`](notebooks/071_SSL.ipynb)  
**üß± –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** [`src/models/tiny_vit.py`](src/models/tiny_vit.py)  
**üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** `TinyViT-11M`, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã–π —á–µ—Ä–µ–∑ MAE (Masked Autoencoding)  
**üß™ SSL –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏–µ:** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –Ω–æ—É—Ç–±—É–∫–µ —Å –Ω—É–ª—è (—Å–º. `MAEWrapper` –≤–Ω—É—Ç—Ä–∏ [`071_SSL.ipynb`](notebooks/071_SSL.ipynb))  
**üóÇÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–æ—Ç –∂–µ –¥–∞—Ç–∞—Å–µ—Ç, —á—Ç–æ –∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è** (—á–µ—Ä–µ–∑ [`MAEDataset`](src/mae_dataset.py) ‚Äî –ø—Ä–æ—Å—Ç–∞—è –ø–æ–¥–∞—á–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫)  
**‚è≥ –í—Å–µ–≥–æ —ç–ø–æ—Ö:** 435  
**üíæ –í–µ—Å–∞:** `ssl_vit_1_5_best.pth` ‚Äî [—Å–∫–∞—á–∞—Ç—å —Å Yandex Disk](https://disk.yandex.ru/d/DfZp4Qd3suAzPQ)  
**üß™ F1-score (–≤–∞–ª–∏–¥–∞—Ü–∏—è):** **0.7252**

**‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏—è (MAE)**

| –ü–∞—Ä–∞–º–µ—Ç—Ä         | –ó–Ω–∞—á–µ–Ω–∏–µ                                |
|------------------|------------------------------------------|
| Epochs           | 50                                       |
| Loss             | `MSELoss()`                              |
| Optimizer        | `AdamW(lr=3e-4, weight_decay=1e-3)`      |
| Scheduler        | `CosineAnnealingLR(T_max=50, eta_min=1e-6)` |

**‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –ó–Ω–∞—á–µ–Ω–∏–µ                                |
|---------------|-----------------------------------------|
| –û–ø—Ç–∏–º–∞–π–∑–µ—Ä    | `AdamW`, `lr=3e-3 - 3e-4`, `weight_decay=1e-4` |
| Scheduler     | `OneCycleLR` / `CosineAnnealingLR`      |
| –≠–ø–æ—Ö          | –æ—Ç 10 –¥–æ 75 (–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤)       |
| Loss          | `CrossEntropyLoss` + `LabelSmoothing=0.1` |
| MixUp         | `alpha=0.25-1.0`, `p=0.5`             |
| CutMix        | `alpha=0.25-1.0`, `p=0.5`                 |

üìù –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ scheduler –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π.  
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [`–Ω–æ—É—Ç–±—É–∫–µ`](notebooks/071_SSL.ipynb).

### enet_v2_m

**üìÅ –û–±—É—á–µ–Ω–∏–µ:** [`090_enetv2_m.ipynb`](notebooks/090_enetv2_m.ipynb)  
**üß± –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** [`src/models/enet.py`](src/models/enet.py)  
**üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è EfficientNetV2-M (~50M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø—Ä–æ—Ç–∏–≤ ~80M –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)  
**‚è≥ –í—Å–µ–≥–æ —ç–ø–æ—Ö:** 350  
**üíæ –í–µ—Å–∞:** `enet_1_5_best.pth` ‚Äî [—Å–∫–∞—á–∞—Ç—å —Å Yandex Disk](https://disk.yandex.ru/d/DfZp4Qd3suAzPQ)  
**üß™ F1-score (–≤–∞–ª–∏–¥–∞—Ü–∏—è):** **0.7147**

**‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –ó–Ω–∞—á–µ–Ω–∏–µ                                |
|---------------|-----------------------------------------|
| –û–ø—Ç–∏–º–∞–π–∑–µ—Ä    | `AdamW`, `lr=3e-3 - 3e-4`, `weight_decay=1e-4` |
| Scheduler     | `OneCycleLR` / `CosineAnnealingLR`      |
| –≠–ø–æ—Ö          | –æ—Ç 50 –¥–æ 75 (–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤)       |
| Loss          | `CrossEntropyLoss` + `LabelSmoothing=0.1` |
| MixUp         | `alpha=0.5-1.0`, `p=0.5`             |
| CutMix        | `alpha=0.5-1.0`, `p=0.5`                 |

üìù –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ scheduler –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π.  
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [`–Ω–æ—É—Ç–±—É–∫–µ`](notebooks/090_enetv2_m.ipynb).

### convnextv2_base

**üìÅ –û–±—É—á–µ–Ω–∏–µ:** —É –Ω–µ–≥–æ –Ω–µ—Ç —Å–≤–æ–µ–≥–æ –Ω–æ—É—Ç–±—É–∫–∞, —Ç–∞–∫ –∫–∞–∫ –µ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è –ü–û–õ–ù–û–°–¢–¨–Æ –°–û–í–ü–ê–î–ê–ï–¢ —Å –Ω–æ—É—Ç–±—É–∫–æ–º convnextv2_small (–Ω–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É –º–µ–Ω—è –µ—Å—Ç—å –≤—Å–µ –ª–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è –≤ wandb)  
**üß± –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** [`src/models/convnextv2.py`](src/models/convnextv2.py)  
**üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** `ConvNeXtV2-Base`, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –Ω—É–ª—è –±–µ–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏—è –∏ –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
**üì¶ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** ~87M (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –æ—Ç Meta AI)  
**‚è≥ –í—Å–µ–≥–æ —ç–ø–æ—Ö:** 250  
**üíæ –í–µ—Å–∞:** `convnextv2_base_3_best.pth` ‚Äî [—Å–∫–∞—á–∞—Ç—å —Å Yandex Disk](https://disk.yandex.ru/d/DfZp4Qd3suAzPQ)  
**üß™ F1-score (–≤–∞–ª–∏–¥–∞—Ü–∏—è):** **0.6958**

**‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä    | –ó–Ω–∞—á–µ–Ω–∏–µ                                                                 |
|-------------|--------------------------------------------------------------------------|
| –û–ø—Ç–∏–º–∞–π–∑–µ—Ä  | `AdamW`, `lr=3e-4`, `betas=(0.9, 0.999)`, `weight_decay=0.05`            |
| Scheduler   | `OneCycleLR` / `CosineAnnealingLR`                |
| –≠–ø–æ—Ö        | 200                                                                       |
| Loss        | `CrossEntropyLoss` + `LabelSmoothing=0.1`                               |
| AMP         | `torch.amp.GradScaler()` (mixed precision)                              |
| MixUp       | `alpha=0.8`, `p=1.0`, `switch_prob=0.5`                                  |
| CutMix      | `alpha=1.0`, `p=1.0`, `switch_prob=0.5`                                  |

üìù –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ scheduler –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π.  
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [`–Ω–æ—É—Ç–±—É–∫–µ`](notebooks/100_convnextv2small.ipynb).

### convnextv2_small

**üìÅ –û–±—É—á–µ–Ω–∏–µ:** [`100_convnextv2small.ipynb`](notebooks/100_convnextv2small.ipynb)  
**üß± –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** [`src/models/convnextv2.py`](src/models/convnextv2.py)  
**üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** `ConvNeXtV2-Small`, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –Ω—É–ª—è –±–µ–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏—è –∏ –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
**üì¶ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** ~50M (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –æ—Ç Meta AI)  
**‚è≥ –í—Å–µ–≥–æ —ç–ø–æ—Ö:** 200  
**üíæ –í–µ—Å–∞:** `convnextv2_small_3_best.pth` ‚Äî [—Å–∫–∞—á–∞—Ç—å —Å Yandex Disk](https://disk.yandex.ru/d/DfZp4Qd3suAzPQ)  
**üß™ F1-score (–≤–∞–ª–∏–¥–∞—Ü–∏—è):** **0.7188**

**‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä    | –ó–Ω–∞—á–µ–Ω–∏–µ                                                                 |
|-------------|--------------------------------------------------------------------------|
| –û–ø—Ç–∏–º–∞–π–∑–µ—Ä  | `AdamW`, `lr=3e-4`, `betas=(0.9, 0.999)`, `weight_decay=0.05`            |
| Scheduler   | `OneCycleLR` / `CosineAnnealingLR`                |
| –≠–ø–æ—Ö        | 200                                                                       |
| Loss        | `CrossEntropyLoss` + `LabelSmoothing=0.1`                               |
| AMP         | `torch.amp.GradScaler()` (mixed precision)                              |
| MixUp       | `alpha=0.8`, `p=1.0`, `switch_prob=0.5`                                  |
| CutMix      | `alpha=1.0`, `p=1.0`, `switch_prob=0.5`                                  |

üìù –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ scheduler –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π.  
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ [`–Ω–æ—É—Ç–±—É–∫–µ`](notebooks/100_convnextv2small.ipynb).

